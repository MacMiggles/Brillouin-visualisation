import numpy as np 
import matplotlib.pyplot as plt
from scipy.spatial import Voronoi, ConvexHull
from mpl_toolkits.mplot3d.art3d import Poly3DCollection

#bcc

a_1 = np.array([ 1,  1, 0])
a_2 = np.array([ 0,  1, 1])
a_3 = np.array([ 1,  0, 1])


nenner = (np.dot(a_1, np.cross(a_2, a_3))) / (2 * np.pi)

b_1 = np.cross(a_2, a_3) / nenner
b_2 = np.cross(a_3, a_1) / nenner
b_3 = np.cross(a_1, a_2) / nenner


points = []

N = 1

for i in range(-N, N+1):
    for j in range(-N, N+1):
        for k in range(-N, N+1):
            points.append(i*b_1 + j*b_2 + k*b_3)

points = np.array(points)


fig = plt.figure()
ax = fig.add_subplot(111, projection='3d')

ax.scatter(points[:,0], points[:,1], points[:,2], s=60, color='blue')
ax.scatter(0, 0, 0, color='red', s=80)  # Ursprung

# gleiche Achsenskalierung
max_range = np.max(np.ptp(points, axis=0))
mid = points.mean(axis=0)

ax.set_xlim(mid[0]-max_range/2, mid[0]+max_range/2)
ax.set_ylim(mid[1]-max_range/2, mid[1]+max_range/2)
ax.set_zlim(mid[2]-max_range/2, mid[2]+max_range/2)

ax.set_xlabel('kx')
ax.set_ylabel('ky')
ax.set_zlabel('kz')

plt.tight_layout()
plt.show()
